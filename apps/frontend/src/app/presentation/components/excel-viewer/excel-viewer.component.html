@if (excelFile()) {
    <div class="excel-viewer-container">
        <table mat-table [dataSource]="dataSource" class="excel-table">
            <ng-container matColumnDef="{{displayedColumns[0]}}" sticky>
                <th mat-header-cell *matHeaderCellDef
                    [class]="getColumnClass(0)"
                    (click)="onColumnHeaderClick(0)"
                    [attr.aria-label]="'Select column ' + displayedColumns[0] + ' as ' + (getColumnClass(0) === 'question-column' ? 'questions' : getColumnClass(0) === 'answer-column' ? 'answers' : '')">
                    {{displayedColumns[0]}}
                </th>
                <td mat-cell *matCellDef="let row">
                    {{row[displayedColumns[0]]}}
                </td>
            </ng-container>
            @for (column of displayedColumns; track column; let i = $index) {
                @if (i !== 0) {
                    <ng-container matColumnDef="{{column}}">
                        <th mat-header-cell *matHeaderCellDef
                            [class]="getColumnClass(i)"
                            (click)="onColumnHeaderClick(i)"
                            [attr.aria-label]="'Select column ' + column + ' as ' + (getColumnClass(i) === 'question-column' ? 'questions' : getColumnClass(i) === 'answer-column' ? 'answers' : '')">
                            {{column}}
                        </th>
                        <td mat-cell *matCellDef="let row">
                            {{row[column]}}
                        </td>
                    </ng-container>
                }
            }

            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
} @else {
    <div class="no-file-message">
        No Excel file loaded
    </div>
}